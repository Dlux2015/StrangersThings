(this["webpackJsonpUNIV.Lab.ReactRouter"]=this["webpackJsonpUNIV.Lab.ReactRouter"]||[]).push([[0],{33:function(e,t,n){"use strict";n.r(t);var s=n(1),r=n(20),c=n.n(r),i=n(3),a=n.n(i),o=n(7),j=n(2),d=n(0),l=function(){return Object(d.jsx)(d.Fragment,{children:Object(d.jsx)("body",{id:"home-background",children:Object(d.jsx)("h1",{id:"home",children:"Welcome to Stranger's things"})})})},u=n(4),b=function(e){var t=e.user,n=e.setToken,s=e.setUser;return null!==e.lstoken?Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("section",{id:"Navbar",children:[Object(d.jsx)("h1",{id:"Nav-title",children:" Stranger's Things"}),Object(d.jsxs)(u.b,{id:"header-link",to:"/",children:[" ","Home"]}),Object(d.jsxs)(u.b,{id:"header-link",to:"/Posts",children:[" ","Posts"]}),Object(d.jsxs)(u.b,{id:"header-link",to:"/Profile",children:[" ","Profile"]}),Object(d.jsx)(u.b,{id:"header-link",to:"/",onClick:function(){n(""),s([]),localStorage.removeItem("token")},children:"Log Out"}),Object(d.jsx)("div",{id:"Nav-user",children:t&&Object(d.jsxs)("span",{children:["Welcome ",t.username]})})]})}):Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("section",{id:"Navbar",children:[Object(d.jsx)("h1",{id:"Nav-title",children:" Stranger's Things"}),Object(d.jsxs)(u.b,{id:"header-link",to:"/",children:[" ","Home"]}),Object(d.jsxs)(u.b,{id:"header-link",to:"/Posts",children:[" ","Posts"]}),Object(d.jsxs)(u.b,{id:"header-link",to:"/Register",children:[" ","Register"]}),Object(d.jsxs)(u.b,{id:"header-link",to:"/Login",children:[" ","Login"]})]})})},h=n(12),p=function(e){var t=e.posts,n=e.setPosts,r=e.refreshPosts,c=(e.token,Object(h.useHistory)(),Object(s.useState)("")),i=Object(j.a)(c,2),a=i[0],o=i[1],l=Object(s.useState)([]),b=Object(j.a)(l,2),p=b[0],O=b[1],x=function(e){e.preventDefault(),o(e.target.value);var t=r.filter((function(t){return t.description.includes(e.target.value)||t.title.includes(e.target.value)||t.price.includes(e.target.value)||t.location.includes(e.target.value)}));O(t)};return null!==localStorage.getItem("token")?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{id:"beforepost",children:[Object(d.jsx)("h1",{id:"post-header-1",children:"Posts"}),Object(d.jsx)("form",{id:"search-1",children:Object(d.jsx)("input",{id:"search-form-1",type:"text",placeholder:"Search Posts",value:a,onChange:x})}),Object(d.jsx)("button",{onClick:function(){n(p)},children:"Search!"}),Object(d.jsx)(u.b,{id:"new-post",to:"/newpost",children:Object(d.jsx)("button",{children:"NewPost"})})]}),t.map((function(e){return Object(d.jsxs)("div",{id:"user-posts",children:[Object(d.jsxs)(u.b,{to:"/posts/".concat(e._id),children:[Object(d.jsx)("h2",{children:e.title})," "]}),Object(d.jsx)("p",{children:e.description}),Object(d.jsx)("h3",{children:e.price}),Object(d.jsx)("h3",{children:e.location}),Object(d.jsx)("h3",{children:e.willDeliver}),Object(d.jsx)("hr",{})]},e._id)}))]}):Object(d.jsxs)(d.Fragment,{children:[" ",Object(d.jsxs)("div",{id:"beforepost",children:[Object(d.jsx)("h1",{id:"post-header",children:"Posts"}),Object(d.jsx)("div",{children:Object(d.jsxs)("form",{id:"search",children:[Object(d.jsx)("input",{id:"search-form",type:"text",placeholder:"Search Posts",value:a,onChange:x}),Object(d.jsx)("button",{onClick:function(){n(p)},children:"Search!"})]})})]}),t.map((function(e){return Object(d.jsxs)("div",{id:"user-posts",children:[Object(d.jsx)("h2",{children:e.title}),Object(d.jsx)("p",{children:e.description}),Object(d.jsx)("h3",{children:e.price}),Object(d.jsx)("h3",{children:e.location}),Object(d.jsx)("h3",{children:e.willDeliver}),Object(d.jsx)("hr",{})]},e._id)}))]})},O=function(e){var t=e.setToken,n=Object(s.useState)(""),r=Object(j.a)(n,2),c=r[0],i=r[1],l=Object(s.useState)(""),u=Object(j.a)(l,2),b=u[0],p=u[1],O=Object(s.useState)(""),x=Object(j.a)(O,2),f=x[0],v=x[1],g=Object(s.useState)(""),m=Object(j.a)(g,2),k=m[0],y=m[1],S=Object(h.useHistory)(),P=function(){var e=Object(o.a)(a.a.mark((function e(n){var s,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),y(""),b===f){e.next=5;break}return y("confirm password does not match original password"),e.abrupt("return");case 5:return e.next=7,fetch("".concat(w,"/users/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:c,password:b}})});case 7:return s=e.sent,e.next=10,s.json();case 10:if(r=e.sent,console.log(r),!r.error){e.next=14;break}return e.abrupt("return",y(r.error.message));case 14:t(r.data.token),localStorage.setItem("token",r.data.token),S.push("/");case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("form",{id:"register",onSubmit:P,children:[Object(d.jsx)("h1",{id:"register-header",children:"Register"}),Object(d.jsxs)("div",{children:[Object(d.jsx)("input",{id:"register",minLength:8,required:!0,placeholder:"Enter username..",value:c,onChange:function(e){return i(e.target.value)}}),Object(d.jsx)("input",{id:"register",minLength:8,required:!0,placeholder:"Enter password..",value:b,onChange:function(e){return p(e.target.value)}}),Object(d.jsx)("input",{id:"register",minLength:8,required:!0,placeholder:"Confirm password",value:f,onChange:function(e){return v(e.target.value)}})]}),Object(d.jsx)("button",{id:"register-button",children:"Register"})]}),Object(d.jsx)("p",{children:k})]})},x=n(5),f=function(e){var t=e.lstoken,n=Object(x.useHistory)(),r=Object(s.useState)([]),c=Object(j.a)(r,2),i=c[0],l=c[1],u=Object(s.useState)([]),b=Object(j.a)(u,2),h=b[0],p=b[1],O=Object(s.useState)([]),f=Object(j.a)(O,2),v=f[0],g=f[1],m=Object(s.useState)([]),k=Object(j.a)(m,2),y=k[0],S=k[1],P=Object(s.useState)([!1]),C=Object(j.a)(P,2),T=C[0],D=C[1],E=Object(s.useState)(""),N=Object(j.a)(E,2),L=N[0],R=N[1],_=function(){var e=Object(o.a)(a.a.mark((function e(s){var r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,fetch("".concat(w,"/posts"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({post:{title:i,description:h,price:v,location:y,willDeliver:T}})});case 3:return r=e.sent,e.next=6,r.json();case 6:if(!(c=e.sent).error){e.next=9;break}return e.abrupt("return",R(c.error.message));case 9:n.push("/posts");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("form",{id:"new-post-form",onSubmit:_,children:[Object(d.jsx)("h2",{children:"New Post"}),Object(d.jsx)("input",{type:"text",placeholder:"What are you selling?",onChange:function(e){return l(e.target.value)},value:i}),Object(d.jsx)("input",{type:"text",placeholder:"Describe the item (i.e. condition, model)",onChange:function(e){return p(e.target.value)},value:h}),Object(d.jsx)("input",{type:"number",placeholder:"What's the price?",onChange:function(e){return g(e.target.value)},value:v}),Object(d.jsx)("input",{type:"text",placeholder:"Where is the item located?",onChange:function(e){return S(e.target.value)},value:y}),Object(d.jsxs)("label",{children:["Are you willing to deliver?",Object(d.jsxs)("select",{onChange:function(e){return D(e.target.value)},children:[Object(d.jsx)("option",{value:!1,children:"No"}),Object(d.jsx)("option",{value:!0,children:"Yes"})]})]}),Object(d.jsx)("button",{children:"Submit"})]}),Object(d.jsx)("p",{children:L})]})},v=n(11),g=function(e){var t=e.posts,n=e.lstoken,r=Object(h.useParams)().id,c=t.filter((function(e){return e._id===r}))[0],i=c.title,l=c.description,u=c.price,b=c.location,p=c.willDeliver,O={title:i,description:l,price:u,location:b,willDeliver:p},x=Object(h.useHistory)(),f=Object(s.useState)(""),g=Object(j.a)(f,2),m=(g[0],g[1]),k=Object(s.useState)(O),y=Object(j.a)(k,2),S=y[0],P=y[1],C=function(){var e=Object(o.a)(a.a.mark((function e(t){var s,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("".concat(w,"/posts/").concat(S._id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({post:{title:i,description:l,price:u,location:b,willDeliver:p}})});case 3:return s=e.sent,e.next=6,s.json();case 6:if(!(r=e.sent).error){e.next=9;break}return e.abrupt("return",m(r.error.message));case 9:console.log(S.price),console.log("it works"),x.push("/posts");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("div",{id:"edit-form",children:[Object(d.jsxs)("form",{className:"post-form",onSubmit:C,children:[Object(d.jsx)("div",{id:"edit-form-title",children:"Edit Form"}),Object(d.jsx)("input",{value:S.title,placeholder:"Title",onChange:function(e){P(Object(v.a)(Object(v.a)({},S),{},{title:e.target.value}))}}),Object(d.jsx)("input",{value:S.description,placeholder:"Description",onChange:function(e){P(Object(v.a)(Object(v.a)({},S),{},{description:e.target.value}))}}),Object(d.jsx)("input",{value:S.price,placeholder:"Price",onChange:function(e){P(Object(v.a)(Object(v.a)({},S),{},{price:e.target.value}))}}),Object(d.jsx)("input",{value:S.location,placeholder:"Location",onChange:function(e){P(Object(v.a)(Object(v.a)({},S),{},{location:e.target.value}))}}),Object(d.jsxs)("select",{onChange:function(e){P(Object(v.a)(Object(v.a)({},S),{},{willDeliver:e.target.value}))},children:[Object(d.jsx)("option",{value:!1,children:"No"}),Object(d.jsx)("option",{value:!0,children:"Yes"})]}),Object(d.jsx)("button",{children:"Submit"})]}),"s"]})})},m=function(e){var t=e.setToken,n=Object(s.useState)(""),r=Object(j.a)(n,2),c=r[0],i=r[1],l=Object(s.useState)(""),u=Object(j.a)(l,2),b=u[0],h=u[1],p=Object(s.useState)(""),O=Object(j.a)(p,2),f=O[0],v=O[1],g=Object(x.useHistory)(),m=function(){var e=Object(o.a)(a.a.mark((function e(n){var s,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,fetch("".concat(w,"/users/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:c,password:b}})});case 3:return s=e.sent,e.next=6,s.json();case 6:if(!(r=e.sent).error){e.next=11;break}return i(""),h(""),e.abrupt("return",v(r.error.message));case 11:t(r.data.token),localStorage.setItem("token",r.data.token),i(""),h(""),g.push("/posts");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{id:"login",children:[Object(d.jsxs)("form",{id:"Login-form",onSubmit:m,children:[Object(d.jsx)("label",{children:"Username"}),Object(d.jsx)("input",{type:"text",value:c,placeholder:"Enter Username",onChange:function(e){return i(e.target.value)}}),Object(d.jsx)("label",{children:"Password"}),Object(d.jsx)("input",{type:"text",value:b,placeholder:"Enter Password",onChange:function(e){return h(e.target.value)}}),Object(d.jsx)("button",{type:"submit",children:"Login"})]}),Object(d.jsx)("p",{children:f})]})},k=function(e){var t=e.user,n=Object(s.useState)([]),r=Object(j.a)(n,2),c=r[0],i=r[1];Object(s.useEffect)((function(){i(t.posts)}),[t]);var l=function(){var e=Object(o.a)(a.a.mark((function e(t){var n,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("".concat(w,"/posts/").concat(post._id),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(lstoken)}});case 3:return n=e.sent,e.next=6,n.json();case 6:if(!(s=e.sent).error){e.next=9;break}return e.abrupt("return",setError(s.error.message));case 9:history.push("/posts");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{id:"profile-main",children:[Object(d.jsxs)("h1",{className:"page-title",children:["Your Profile, ",t.username]}),Object(d.jsxs)("div",{className:"profile-body",children:[t.messages&&t.messages.length?Object(d.jsx)("div",{children:Object(d.jsxs)("div",{id:"inbox-span",children:[Object(d.jsxs)("h3",{id:"inbox",children:["Inbox (",t.messages.length,")"]}),t.messages.map((function(e){return Object(d.jsxs)("div",{id:"message",children:[Object(d.jsxs)("div",{id:"post-message",children:["From Post:",e.post.title]}),Object(d.jsxs)("label",{id:"sender",children:["Sender:",e.fromUser.username]}),Object(d.jsx)("p",{id:"message-content",children:e.content})]},e._id)}))]})}):Object(d.jsx)("h3",{children:"There are no messages to display"}),c&&c.length?Object(d.jsxs)("div",{id:"user-posts",children:[Object(d.jsx)("h2",{children:"Listings you've created: "}),c.map((function(e){return Object(d.jsxs)("div",{id:"profile-posts",children:[Object(d.jsx)(u.b,{to:"/posts/".concat(e._id),children:Object(d.jsx)("h4",{children:e.title})}),Object(d.jsx)("div",{children:Object(d.jsxs)("h5",{children:["Active: ",e.active?"true":"false"]})}),Object(d.jsxs)("div",{children:[Object(d.jsx)("h5",{children:"Description:"})," ",e.description]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("h5",{}),"Location: ",e.location]}),Object(d.jsx)("button",{onClick:function(){return l(e._id)},children:"Delete"}),Object(d.jsx)(u.b,{id:"send-message",to:"/posts/edit/".concat(e._id),children:Object(d.jsx)("button",{children:"Edit"})})]},e._id)}))]}):Object(d.jsx)("h2",{children:"You haven't created any posts yet."})]})]})},y=function(e){var t=e.posts,n=e.lstoken,r=Object(x.useParams)().id,c=t.find((function(e){return r===e._id})),i=Object(s.useState)(""),l=Object(j.a)(i,2),u=l[0],b=l[1],h=Object(s.useState)(""),p=Object(j.a)(h,2),O=(p[0],p[1]),f=Object(x.useHistory)(),v=function(){var e=Object(o.a)(a.a.mark((function e(t){var s,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("".concat(w,"/posts/").concat(c._id,"/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({message:{content:u}})});case 3:return s=e.sent,e.next=6,s.json();case 6:if(!(r=e.sent).error){e.next=9;break}return e.abrupt("return",O(r.error.message));case 9:console.log(u),f.push("/profile");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsx)(d.Fragment,{children:n?Object(d.jsx)("div",{id:"message-format",children:Object(d.jsxs)("form",{id:"message-form",onSubmit:v,children:[Object(d.jsx)("h2",{children:"Message Form"}),Object(d.jsx)("label",{id:"comment-input",children:"Message "}),Object(d.jsx)("input",{value:u,onChange:function(e){b(e.target.value)},id:"comment-input"}),Object(d.jsx)("button",{children:"submit"})]})}):Object(d.jsx)("div",{children:" Please login to message other users"})})},S=function(e){var t=e.posts,n=e.lstoken;if(0===t.length)return Object(d.jsx)("div",{});var s=Object(h.useParams)().id,r=t.find((function(e){return s==e._id})),c=Object(h.useHistory)(),i=function(){var e=Object(o.a)(a.a.mark((function e(t){var s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(w,"/posts/").concat(r._id),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}});case 2:return s=e.sent,e.next=5,s.json();case 5:if(!(i=e.sent).error){e.next=8;break}return e.abrupt("return",setError(i.error.message));case 8:c.push("/posts");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsx)(d.Fragment,{children:Object(d.jsx)("div",{id:"post-results-box",children:r&&r.isAuthor?Object(d.jsxs)("div",{id:"post-results",children:[Object(d.jsx)("h3",{id:"post-title",children:r.title}),Object(d.jsxs)("div",{id:"post-info",children:["Active: ",r.active?"true":"false"]}),Object(d.jsxs)("div",{id:"post-info",children:["Description: ",r.description]}),Object(d.jsxs)("div",{id:"post-info",children:["Price: ",r.price]}),Object(d.jsxs)("div",{id:"post-info",children:["Posted by: ",r.author.username]}),Object(d.jsxs)("div",{id:"post-info",children:["Location: ",r.location," "]}),Object(d.jsx)("button",{id:"delete",onClick:function(){i()},children:"Delete"}),Object(d.jsx)(u.b,{id:"send-message",to:"/posts/edit/".concat(r._id),children:Object(d.jsx)("button",{id:"edit",children:"Edit"})})]}):Object(d.jsx)("div",{children:Object(d.jsxs)("div",{id:"post-results",children:[Object(d.jsx)("h3",{id:"post-title",children:r.title}),Object(d.jsxs)("div",{id:"post-info",children:["Description: ",r.description]}),Object(d.jsxs)("div",{id:"post-info",children:["Price: ",r.price]}),Object(d.jsxs)("div",{id:"post-info",children:["Posted by: ",r.author.username]}),Object(d.jsxs)("div",{id:"post-info",children:["Location: ",r.location," "]}),Object(d.jsx)(u.b,{id:"send-message",to:"message/".concat(r._id),children:Object(d.jsx)("button",{children:"Send Message"})})]})})})})},w="https://strangers-things.herokuapp.com/api/2110-FTB-ET-WEB-PT",P=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],r=t[1],c=Object(s.useState)([]),i=Object(j.a)(c,2),h=i[0],v=i[1],P=Object(s.useState)([]),C=Object(j.a)(P,2),T=C[0],D=C[1],E=Object(s.useState)(""),N=Object(j.a)(E,2),L=N[0],R=N[1],_=Object(s.useState)(null),F=Object(j.a)(_,2),A=F[0],B=F[1],H=localStorage.getItem("token"),I=function(){var e=Object(o.a)(a.a.mark((function e(){var t,n,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=localStorage.getItem("token"))&&R(t),e.prev=2,e.next=5,fetch("".concat(w,"/users/me"),{headers:{Authorization:"Bearer ".concat(t)}});case 5:return n=e.sent,e.next=8,n.json();case 8:(s=e.sent).success&&B(s.data),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}();function z(){return(z=Object(o.a)(a.a.mark((function e(){var t,n,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!H){e.next=13;break}return e.next=3,fetch("".concat(w,"/posts"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(H)}});case 3:return t=e.sent,console.log(t),e.next=7,t.json();case 7:n=e.sent,D(n.data.posts),v(n.data.posts),r(n.data.posts),e.next=22;break;case 13:return e.next=15,fetch("".concat(w,"/posts"));case 15:return s=e.sent,e.next=18,s.json();case 18:c=e.sent,D(c.data.posts),v(c.data.posts),r(c.data.posts);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){I(),function(){z.apply(this,arguments)}()}),[L]),Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(u.a,{children:Object(d.jsxs)("div",{id:"container",children:[Object(d.jsx)("div",{id:"navbar",children:Object(d.jsx)("div",{id:"navbar-sub",children:Object(d.jsx)(b,{user:A,setToken:R,setUser:B,lstoken:H})})}),Object(d.jsxs)("div",{id:"main-section",children:[Object(d.jsx)(x.Route,{exact:!0,path:"/",children:Object(d.jsx)(l,{})}),Object(d.jsx)(x.Route,{exact:!0,path:"/posts",children:Object(d.jsx)(p,{posts:T,refreshPosts:h,setPosts:D,token:L})}),Object(d.jsx)(x.Route,{exact:!0,path:"/register",children:Object(d.jsx)(O,{setToken:R})}),Object(d.jsx)(x.Route,{exact:!0,path:"/newpost",children:Object(d.jsx)(f,{lstoken:H})}),Object(d.jsx)(x.Route,{exact:!0,path:"/posts/:id",children:Object(d.jsx)(S,{token:L,setPosts:D,posts:T,lstoken:H})}),Object(d.jsx)(x.Route,{exact:!0,path:"/posts/edit/:id",children:Object(d.jsx)(g,{posts:T,lstoken:H})}),Object(d.jsx)(x.Route,{exact:!0,path:"/login",children:Object(d.jsx)(m,{setToken:R})}),Object(d.jsx)(x.Route,{exact:!0,path:"/posts/message/:id",children:Object(d.jsx)(y,{posts:T,lstoken:H})}),Object(d.jsx)(x.Route,{exact:!0,path:"/Profile",children:Object(d.jsx)(k,{user:A,posts:T,setPosts:D,userPost:n})})]})]})})})},C=document.getElementById("app");c.a.render(Object(d.jsx)(P,{}),C)}},[[33,1,2]]]);
//# sourceMappingURL=main.a729f099.chunk.js.map