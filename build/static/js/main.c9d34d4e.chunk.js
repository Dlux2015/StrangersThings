(this["webpackJsonpUNIV.Lab.ReactRouter"]=this["webpackJsonpUNIV.Lab.ReactRouter"]||[]).push([[0],{33:function(e,t,s){"use strict";s.r(t);var n=s(1),r=s(20),c=s.n(r),i=s(4),o=s.n(i),a=s(7),j=s(2),d=s(0),l=function(){return Object(d.jsx)(d.Fragment,{children:Object(d.jsx)("body",{id:"home-background",children:Object(d.jsx)("h1",{id:"home",children:"Welcome to Stranger's things"})})})},u=s(3),b=function(e){var t=e.user,s=e.setToken,n=e.setUser;return null!==e.lstoken?Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("section",{id:"Navbar",children:[Object(d.jsx)("h1",{id:"Nav-title",children:" Stranger's Things"}),Object(d.jsxs)(u.b,{id:"header-link",to:"/",children:[" ","Home"]}),Object(d.jsxs)(u.b,{id:"header-link",to:"/Posts",children:[" ","Posts"]}),Object(d.jsxs)(u.b,{id:"header-link",to:"/Profile",children:[" ","Profile"]}),Object(d.jsx)(u.b,{id:"header-link",to:"/",onClick:function(){s(""),n([]),localStorage.removeItem("token")},children:"Log Out"}),Object(d.jsx)("div",{id:"Nav-user",children:t&&Object(d.jsxs)("span",{children:["Welcome ",t.username]})})]})}):Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("section",{id:"Navbar",children:[Object(d.jsx)("h1",{id:"Nav-title",children:" Stranger's Things"}),Object(d.jsxs)(u.b,{id:"header-link",to:"/",children:[" ","Home"]}),Object(d.jsxs)(u.b,{id:"header-link",to:"/Posts",children:[" ","Posts"]}),Object(d.jsxs)(u.b,{id:"header-link",to:"/Register",children:[" ","Register"]}),Object(d.jsxs)(u.b,{id:"header-link",to:"/Login",children:[" ","Login"]})]})})},h=s(15),p=function(e){var t=e.posts,s=e.setPosts,r=e.refreshPosts,c=(e.token,Object(h.useHistory)(),Object(n.useState)("")),i=Object(j.a)(c,2),o=i[0],a=i[1],l=Object(n.useState)([]),b=Object(j.a)(l,2),p=b[0],O=b[1],x=function(e){e.preventDefault(),a(e.target.value);var t=r.filter((function(t){return t.description.includes(e.target.value)||t.title.includes(e.target.value)||t.price.includes(e.target.value)||t.location.includes(e.target.value)}));O(t)};return null!==localStorage.getItem("token")?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{id:"beforepost",children:[Object(d.jsx)("h1",{id:"post-header-1",children:"Posts"}),Object(d.jsx)("form",{id:"search-1",children:Object(d.jsx)("input",{id:"search-form-1",type:"text",placeholder:"Search Posts",value:o,onChange:x})}),Object(d.jsx)("button",{onClick:function(){s(p)},children:"Search!"}),Object(d.jsx)(u.b,{id:"new-post",to:"/newpost",children:Object(d.jsx)("button",{children:"NewPost"})})]}),t.map((function(e){return Object(d.jsxs)("div",{id:"user-posts",children:[Object(d.jsxs)(u.b,{to:"/posts/".concat(e._id),children:[Object(d.jsx)("h2",{children:e.title})," "]}),Object(d.jsx)("p",{children:e.description}),Object(d.jsx)("h3",{children:e.price}),Object(d.jsx)("h3",{children:e.location}),Object(d.jsx)("h3",{children:e.willDeliver}),Object(d.jsx)("hr",{})]},e._id)}))]}):Object(d.jsxs)(d.Fragment,{children:[" ",Object(d.jsxs)("div",{id:"beforepost",children:[Object(d.jsx)("h1",{id:"post-header",children:"Posts"}),Object(d.jsx)("div",{children:Object(d.jsxs)("form",{id:"search",children:[Object(d.jsx)("input",{id:"search-form",type:"text",placeholder:"Search Posts",value:o,onChange:x}),Object(d.jsx)("button",{onClick:function(){s(p)},children:"Search!"})]})})]}),t.map((function(e){return Object(d.jsxs)("div",{id:"user-posts",children:[Object(d.jsx)("h2",{children:e.title}),Object(d.jsx)("p",{children:e.description}),Object(d.jsx)("h3",{children:e.price}),Object(d.jsx)("h3",{children:e.location}),Object(d.jsx)("h3",{children:e.willDeliver}),Object(d.jsx)("hr",{})]},e._id)}))]})},O=s(5),x=function(e){var t=e.setToken,s=Object(n.useState)(""),r=Object(j.a)(s,2),c=r[0],i=r[1],l=Object(n.useState)(""),u=Object(j.a)(l,2),b=u[0],h=u[1],p=Object(n.useState)(""),x=Object(j.a)(p,2),f=x[0],v=x[1],g=Object(n.useState)(""),m=Object(j.a)(g,2),k=m[0],S=m[1],y=Object(O.useHistory)(),w=function(){var e=Object(a.a)(o.a.mark((function e(s){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),S(""),b===f){e.next=5;break}return S("confirm password does not match original password"),e.abrupt("return");case 5:return e.next=7,fetch("".concat(P,"/users/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:c,password:b}})});case 7:return n=e.sent,e.next=10,n.json();case 10:if(r=e.sent,console.log(r),!r.error){e.next=14;break}return e.abrupt("return",S(r.error.message));case 14:t(r.data.token),localStorage.setItem("token",r.data.token),y.push("/");case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("form",{id:"register",onSubmit:w,children:[Object(d.jsx)("h1",{id:"register-header",children:"Register"}),Object(d.jsxs)("div",{children:[Object(d.jsx)("input",{id:"register",minLength:8,required:!0,placeholder:"Enter username..",value:c,onChange:function(e){return i(e.target.value)}}),Object(d.jsx)("input",{id:"register",minLength:8,required:!0,placeholder:"Enter password..",value:b,onChange:function(e){return h(e.target.value)}}),Object(d.jsx)("input",{id:"register",minLength:8,required:!0,placeholder:"Confirm password",value:f,onChange:function(e){return v(e.target.value)}})]}),Object(d.jsx)("button",{id:"register-button",children:"Register"})]}),Object(d.jsx)("p",{children:k})]})},f=function(e){var t=e.lstoken,s=e.fetchPosts,r=Object(O.useHistory)(),c=Object(n.useState)([]),i=Object(j.a)(c,2),l=i[0],u=i[1],b=Object(n.useState)([]),h=Object(j.a)(b,2),p=h[0],x=h[1],f=Object(n.useState)([]),v=Object(j.a)(f,2),g=v[0],m=v[1],k=Object(n.useState)([]),S=Object(j.a)(k,2),y=S[0],w=S[1],C=Object(n.useState)([!0]),T=Object(j.a)(C,2),D=T[0],N=T[1],E=Object(n.useState)(""),R=Object(j.a)(E,2),L=R[0],F=R[1],_=function(){var e=Object(a.a)(o.a.mark((function e(n){var c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,fetch("".concat(P,"/posts"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({post:{title:l,description:p,price:g,location:y,willDeliver:D}})});case 3:return c=e.sent,e.next=6,c.json();case 6:if(!(i=e.sent).error){e.next=9;break}return e.abrupt("return",F(i.error.message));case 9:s(),r.push("/posts");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("form",{id:"new-post-form",onSubmit:_,children:[Object(d.jsx)("h2",{id:"new-post",children:"New Post"}),Object(d.jsx)("input",{type:"text",placeholder:"What are you selling?",onChange:function(e){return u(e.target.value)},value:l}),Object(d.jsx)("input",{type:"text",placeholder:"Describe the item (i.e. condition, model)",onChange:function(e){return x(e.target.value)},value:p}),Object(d.jsx)("input",{type:"number",placeholder:"What's the price?",onChange:function(e){return m(e.target.value)},value:g}),Object(d.jsx)("input",{type:"text",placeholder:"Where is the item located?",onChange:function(e){return w(e.target.value)},value:y}),Object(d.jsxs)("label",{id:"deliver",children:["Are you willing to deliver?",Object(d.jsxs)("select",{onChange:function(e){return N(e.target.value)},children:[Object(d.jsx)("option",{value:!0,children:"No"}),Object(d.jsx)("option",{value:!0,children:"Yes"})]})]}),Object(d.jsx)("button",{children:"Submit"})]}),Object(d.jsx)("p",{children:L})]})},v=s(11),g=function(e){var t=e.posts,s=e.lstoken,r=e.fetchPosts,c=Object(O.useParams)().id,i=t.filter((function(e){return e._id===c}))[0],l=i.title,u=i.description,b=i.price,h=i.location,p=i.willDeliver,x={title:l,description:u,price:b,location:h,willDeliver:p},f=Object(O.useHistory)(),g=Object(n.useState)(""),m=Object(j.a)(g,2),k=(m[0],m[1]),S=Object(n.useState)(x),y=Object(j.a)(S,2),w=y[0],C=y[1],T=function(){var e=Object(a.a)(o.a.mark((function e(t){var n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("".concat(P,"/posts/").concat(w._id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({post:{title:l,description:u,price:b,location:h,willDeliver:p}})});case 3:return n=e.sent,e.next=6,n.json();case 6:if(!(c=e.sent).error){e.next=9;break}return e.abrupt("return",k(c.error.message));case 9:console.log(w.price),console.log("it works"),r(),f.push("/posts");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("div",{id:"edit-form",children:[Object(d.jsxs)("form",{className:"post-form",onSubmit:T,children:[Object(d.jsx)("div",{id:"edit-form-title",children:"Edit Form"}),Object(d.jsx)("input",{value:w.title,placeholder:"Title",onChange:function(e){C(Object(v.a)(Object(v.a)({},w),{},{title:e.target.value}))}}),Object(d.jsx)("input",{value:w.description,placeholder:"Description",onChange:function(e){C(Object(v.a)(Object(v.a)({},w),{},{description:e.target.value}))}}),Object(d.jsx)("input",{value:w.price,placeholder:"Price",onChange:function(e){C(Object(v.a)(Object(v.a)({},w),{},{price:e.target.value}))}}),Object(d.jsx)("input",{value:w.location,placeholder:"Location",onChange:function(e){C(Object(v.a)(Object(v.a)({},w),{},{location:e.target.value}))}}),Object(d.jsxs)("select",{onChange:function(e){C(Object(v.a)(Object(v.a)({},w),{},{willDeliver:e.target.value}))},children:[Object(d.jsx)("option",{value:!1,children:"No"}),Object(d.jsx)("option",{value:!0,children:"Yes"})]}),Object(d.jsx)("button",{children:"Submit"})]}),"s"]})})},m=function(e){var t=e.setToken,s=Object(n.useState)(""),r=Object(j.a)(s,2),c=r[0],i=r[1],l=Object(n.useState)(""),u=Object(j.a)(l,2),b=u[0],h=u[1],p=Object(n.useState)(""),x=Object(j.a)(p,2),f=x[0],v=x[1],g=Object(O.useHistory)(),m=function(){var e=Object(a.a)(o.a.mark((function e(s){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,fetch("".concat(P,"/users/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:c,password:b}})});case 3:return n=e.sent,e.next=6,n.json();case 6:if(!(r=e.sent).error){e.next=11;break}return i(""),h(""),e.abrupt("return",v(r.error.message));case 11:t(r.data.token),localStorage.setItem("token",r.data.token),i(""),h(""),g.push("/posts");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{id:"login",children:[Object(d.jsxs)("form",{id:"Login-form",onSubmit:m,children:[Object(d.jsx)("label",{children:"Username"}),Object(d.jsx)("input",{type:"text",value:c,placeholder:"Enter Username",onChange:function(e){return i(e.target.value)}}),Object(d.jsx)("label",{children:"Password"}),Object(d.jsx)("input",{type:"text",value:b,placeholder:"Enter Password",onChange:function(e){return h(e.target.value)}}),Object(d.jsx)("button",{type:"submit",children:"Login"})]}),Object(d.jsx)("p",{children:f})]})},k=function(e){var t=e.user,s=(e.lstoken,e.fetchPosts),r=(e.fetchUser,Object(n.useState)([])),c=Object(j.a)(r,2),i=c[0],o=c[1],a=Object(n.useState)(""),l=Object(j.a)(a,2);l[0],l[1];return Object(n.useEffect)((function(){s()}),[]),Object(n.useEffect)((function(){o(t.posts)}),[t]),Object(d.jsxs)("div",{id:"profile-main",children:[Object(d.jsxs)("h1",{className:"page-title",children:["Your Profile, ",t.username]}),Object(d.jsxs)("div",{className:"profile-body",children:[t.messages&&t.messages.length?Object(d.jsx)("div",{children:Object(d.jsxs)("div",{id:"inbox-span",children:[Object(d.jsxs)("h3",{id:"inbox",children:["Inbox (",t.messages.length,")"]}),t.messages.map((function(e){return Object(d.jsxs)("div",{id:"message",children:[Object(d.jsxs)("div",{id:"post-message",children:["From Post:",e.post.title]}),Object(d.jsxs)("label",{id:"sender",children:["Sender:",e.fromUser.username]}),Object(d.jsx)("p",{id:"message-content",children:e.content})]},e._id)}))]})}):Object(d.jsx)("h3",{children:"There are no messages to display"}),i&&i.length?Object(d.jsxs)("div",{id:"user-posts",children:[Object(d.jsx)("h2",{children:"Listings you've created: "}),i.map((function(e){return Object(d.jsxs)("div",{id:"profile-posts",children:[Object(d.jsx)(u.b,{to:"/posts/".concat(e._id),children:Object(d.jsx)("h4",{children:e.title})}),Object(d.jsx)("div",{children:Object(d.jsxs)("h5",{children:["Active: ",e.active?"true":"false"]})}),Object(d.jsxs)("div",{children:[Object(d.jsx)("h5",{children:"Description:"})," ",e.description]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("h5",{}),"Location: ",e.location]}),Object(d.jsx)(u.b,{id:"send-message",to:"/posts/edit/".concat(e._id),children:Object(d.jsx)("button",{children:"Edit"})})]},e._id)}))]}):Object(d.jsx)("h2",{children:"You haven't created any posts yet."})]})]})},S=function(e){var t=e.posts,s=e.lstoken,r=e.fetchPosts,c=e.fetchUser,i=Object(O.useParams)().id,l=t.find((function(e){return i===e._id})),u=Object(n.useState)(""),b=Object(j.a)(u,2),h=b[0],p=b[1],x=Object(n.useState)(""),f=Object(j.a)(x,2),v=(f[0],f[1]),g=Object(O.useHistory)(),m=function(){var e=Object(a.a)(o.a.mark((function e(t){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("".concat(P,"/posts/").concat(l._id,"/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({message:{content:h}})});case 3:return n=e.sent,e.next=6,n.json();case 6:if(!(i=e.sent).error){e.next=9;break}return e.abrupt("return",v(i.error.message));case 9:console.log(h),r(),c(),g.push("/profile");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsx)(d.Fragment,{children:s?Object(d.jsx)("div",{id:"message-format",children:Object(d.jsxs)("form",{id:"message-form",onSubmit:m,children:[Object(d.jsx)("h2",{children:"Message Form"}),Object(d.jsx)("label",{id:"comment-input",children:"Message "}),Object(d.jsx)("input",{value:h,onChange:function(e){p(e.target.value)},id:"comment-input"}),Object(d.jsx)("button",{children:"submit"})]})}):Object(d.jsx)("div",{children:" Please login to message other users"})})},y=function(e){var t=e.posts,s=e.lstoken,n=e.fetchPosts;if(0===t.length)return Object(d.jsx)("div",{});var r=Object(h.useParams)().id,c=t.find((function(e){return r==e._id})),i=Object(h.useHistory)(),j=function(){var e=Object(a.a)(o.a.mark((function e(t){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(P,"/posts/").concat(c._id),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});case 2:return r=e.sent,e.next=5,r.json();case 5:if(!(a=e.sent).error){e.next=8;break}return e.abrupt("return",setError(a.error.message));case 8:n(),i.push("/posts");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsx)(d.Fragment,{children:Object(d.jsx)("div",{id:"post-results-box",children:c&&c.isAuthor?Object(d.jsxs)("div",{id:"post-results",children:[Object(d.jsx)("h3",{id:"post-title",children:c.title}),Object(d.jsxs)("div",{id:"post-info",children:["Active: ",c.active?"true":"false"]}),Object(d.jsxs)("div",{id:"post-info",children:["Description: ",c.description]}),Object(d.jsxs)("div",{id:"post-info",children:["Price: ",c.price]}),Object(d.jsxs)("div",{id:"post-info",children:["Posted by: ",c.author.username]}),Object(d.jsxs)("div",{id:"post-info",children:["Location: ",c.location," "]}),Object(d.jsx)("button",{id:"delete",onClick:function(){j()},children:"Delete"}),Object(d.jsx)(u.b,{id:"send-message",to:"/posts/edit/".concat(c._id),children:Object(d.jsx)("button",{id:"edit",children:"Edit"})})]}):Object(d.jsx)("div",{children:Object(d.jsxs)("div",{id:"post-results",children:[Object(d.jsx)("h3",{id:"post-title",children:c.title}),Object(d.jsxs)("div",{id:"post-info",children:["Description: ",c.description]}),Object(d.jsxs)("div",{id:"post-info",children:["Price: ",c.price]}),Object(d.jsxs)("div",{id:"post-info",children:["Posted by: ",c.author.username]}),Object(d.jsxs)("div",{id:"post-info",children:["Location: ",c.location," "]}),Object(d.jsx)(u.b,{id:"send-message",to:"message/".concat(c._id),children:Object(d.jsx)("button",{children:"Send Message"})})]})})})})},P="https://strangers-things.herokuapp.com/api/2110-FTB-ET-WEB-PT",w=function(){var e=Object(n.useState)([]),t=Object(j.a)(e,2),s=t[0],r=t[1],c=Object(n.useState)([]),i=Object(j.a)(c,2),h=i[0],v=i[1],w=Object(n.useState)([]),C=Object(j.a)(w,2),T=C[0],D=C[1],N=Object(n.useState)(""),E=Object(j.a)(N,2),R=E[0],L=E[1],F=Object(n.useState)(null),_=Object(j.a)(F,2),A=_[0],U=_[1],H=localStorage.getItem("token"),I=function(){var e=Object(a.a)(o.a.mark((function e(){var t,s,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=localStorage.getItem("token"))&&L(t),e.prev=2,e.next=5,fetch("".concat(P,"/users/me"),{headers:{Authorization:"Bearer ".concat(t)}});case 5:return s=e.sent,e.next=8,s.json();case 8:(n=e.sent).success&&U(n.data),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}();function B(){return J.apply(this,arguments)}function J(){return(J=Object(a.a)(o.a.mark((function e(){var t,s,n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!H){e.next=13;break}return e.next=3,fetch("".concat(P,"/posts"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(H)}});case 3:return t=e.sent,console.log(t),e.next=7,t.json();case 7:s=e.sent,D(s.data.posts),v(s.data.posts),r(s.data.posts),e.next=22;break;case 13:return e.next=15,fetch("".concat(P,"/posts"));case 15:return n=e.sent,e.next=18,n.json();case 18:c=e.sent,D(c.data.posts),v(c.data.posts),r(c.data.posts);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){I(),B()}),[R]),Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(u.a,{children:Object(d.jsxs)("div",{id:"container",children:[Object(d.jsx)("div",{id:"navbar",children:Object(d.jsx)("div",{id:"navbar-sub",children:Object(d.jsx)(b,{user:A,setToken:L,setUser:U,lstoken:H})})}),Object(d.jsxs)("div",{id:"main-section",children:[Object(d.jsx)(O.Route,{exact:!0,path:"/",children:Object(d.jsx)(l,{})}),Object(d.jsx)(O.Route,{exact:!0,path:"/posts",children:Object(d.jsx)(p,{posts:T,refreshPosts:h,setPosts:D,token:R})}),Object(d.jsx)(O.Route,{exact:!0,path:"/register",children:Object(d.jsx)(x,{setToken:L})}),Object(d.jsx)(O.Route,{exact:!0,path:"/newpost",children:Object(d.jsx)(f,{lstoken:H,fetchPosts:B})}),Object(d.jsx)(O.Route,{exact:!0,path:"/posts/:id",children:Object(d.jsx)(y,{token:R,setPosts:D,posts:T,lstoken:H,fetchPosts:B})}),Object(d.jsx)(O.Route,{exact:!0,path:"/posts/edit/:id",children:Object(d.jsx)(g,{posts:T,lstoken:H,fetchPosts:B})}),Object(d.jsx)(O.Route,{exact:!0,path:"/login",children:Object(d.jsx)(m,{setToken:L})}),Object(d.jsx)(O.Route,{exact:!0,path:"/posts/message/:id",children:Object(d.jsx)(S,{posts:T,lstoken:H,fetchPosts:B,fetchUser:I})}),Object(d.jsx)(O.Route,{exact:!0,path:"/Profile",children:Object(d.jsx)(k,{user:A,posts:T,setPosts:D,userPost:s,lstoken:H,fetchPosts:B,fetchUser:I})})]})]})})})},C=document.getElementById("app");c.a.render(Object(d.jsx)(w,{}),C)}},[[33,1,2]]]);
//# sourceMappingURL=main.c9d34d4e.chunk.js.map